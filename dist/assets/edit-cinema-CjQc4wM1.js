import{a as l,y as v,j as e,T as f,z as m,B as b,v as _,K as S}from"./TextField-C0C35B0s.js";import{D as T,C as k,a as w,b as D,H as E}from"./admin-BtXtYjBH.js";import{S as H}from"./Stack-DDPYJlOQ.js";import{S as F}from"./Snackbar-DD-lInE4.js";import{A as q}from"./Alert-B1AO4k1G.js";function A({cinemaId:s}){const[r,h]=l.useState({cinema_name:"",address:"",cluster_name:"",region_name:""}),[u,p]=l.useState(!0),[d,i]=l.useState({open:!1,message:"",severity:"success"}),x=v(),g=()=>i(n=>({...n,open:!1}));l.useEffect(()=>{(async()=>{try{const a=await fetch(`/api/admin/cinemas/detail/${s}`);if(!a.ok)throw new Error("Failed to fetch cinema details");const t=await a.json(),c=t.cinema[0]||{},C=t.clusters[0]||{},y=t.regions[0]||{};h({cinema_name:c.cinema_name||"",address:c.address||"",cluster_name:C.cluster_name||"",region_name:y.region_name||""}),p(!1)}catch(a){console.error(a),i({open:!0,message:"Lỗi khi tải thông tin rạp",severity:"error"}),p(!1)}})()},[s]);const o=n=>{const{name:a,value:t}=n.target;h(c=>({...c,[a]:t}))},j=async n=>{n.preventDefault();try{const a=await fetch(`/api/admin/cinemas/edit/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw new Error("Failed to update cinema");const t=await a.json();i({open:!0,message:"Rạp chiếu phim đã được cập nhật thành công!",severity:"success"}),setTimeout(()=>x(-1),1e3)}catch{i({open:!0,message:"Có lỗi xảy ra khi cập nhật rạp!",severity:"error"})}};return e.jsxs(T,{children:[e.jsxs(k,{children:[e.jsx(w,{title:e.jsx(f,{variant:"h2",children:"Chỉnh sửa thông tin rạp"})}),e.jsx(D,{children:u?e.jsx(f,{variant:"body1",children:"Đang tải thông tin rạp..."}):e.jsxs("form",{onSubmit:j,children:[e.jsxs(H,{spacing:3,children:[e.jsx(m,{name:"cinema_name",label:"Tên rạp",value:r.cinema_name,onChange:o,required:!0,fullWidth:!0}),e.jsx(m,{name:"address",label:"Địa chỉ",value:r.address,onChange:o,required:!0,fullWidth:!0}),e.jsx(m,{name:"cluster_name",label:"Tên cụm",value:r.cluster_name,onChange:o,required:!0,fullWidth:!0}),e.jsx(m,{name:"region_name",label:"Tên khu vực",value:r.region_name,onChange:o,required:!0,fullWidth:!0})]}),e.jsx(b,{mt:3,display:"flex",justifyContent:"flex-end",children:e.jsx(_,{type:"submit",variant:"contained",color:"primary",disabled:u,children:"Cập nhật"})})]})})]}),e.jsx(F,{open:d.open,autoHideDuration:6e3,onClose:g,children:e.jsx(q,{onClose:g,severity:d.severity,children:d.message})})]})}function L(){const{id:s}=S();return e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsxs("title",{children:[" ","Chỉnh sửa thông tin rạp chiếu phim | NHTT Admin Panel"]})}),e.jsx(A,{cinemaId:s})]})}export{L as default};
