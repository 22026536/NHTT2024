import{a as u,y as S,j as e,T as y,z as h,B as T,v as k,K as D}from"./TextField-BtRiUif7.js";import{D as E,C as q,a as H,b as F,H as P}from"./admin-DadmEWhV.js";import{S as W}from"./Stack-BfoaOI6W.js";import{S as L}from"./Snackbar-6HqTmQJK.js";import{A as N}from"./Alert-DlJiDsMq.js";function $({showtimeId:o}){const[a,p]=u.useState({film_name:"",room_name:"",cinema_name:"",show_date:"",show_time:""}),[_,f]=u.useState(!0),[d,m]=u.useState({open:!1,message:"",severity:"success"}),C=S(),g=()=>m(n=>({...n,open:!1}));u.useEffect(()=>{(async()=>{var t,s,l,w,x;try{const c=await fetch(`/api/admin/showtimes/detail/${o}`);if(!c.ok)throw new Error("Failed to fetch showtime details");const i=await c.json();console.log(i);const j=((t=i.showTime[0])==null?void 0:t.show_date)||"",v=j?new Date(j).toISOString().split("T")[0]:"";p({film_name:((s=i.film[0])==null?void 0:s.film_name)||"",room_name:((l=i.room[0])==null?void 0:l.room_name)||"",cinema_name:((w=i.cinema[0])==null?void 0:w.cinema_name)||"",show_date:v,show_time:((x=i.showTime[0])==null?void 0:x.show_time)||""}),f(!1)}catch(c){console.error(c),m({open:!0,message:"Lỗi khi tải thông tin suất chiếu",severity:"error"}),f(!1)}})()},[o]);const r=n=>{const{name:t,value:s}=n.target;p(l=>({...l,[t]:s}))},b=async n=>{n.preventDefault();try{const t=await fetch(`/api/admin/showtimes/edit/${o}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to update showtime");const s=await t.json();console.log(s),m({open:!0,message:"Suất chiếu phim đã được cập nhật thành công!",severity:"success"}),setTimeout(()=>C(-1),1e3)}catch(t){console.error(t),m({open:!0,message:"Có lỗi xảy ra khi cập nhật suất chiếu!",severity:"error"})}};return e.jsxs(E,{children:[e.jsxs(q,{children:[e.jsx(H,{title:e.jsx(y,{variant:"h2",children:"Chỉnh sửa thông tin suất chiếu phim"})}),e.jsx(F,{children:_?e.jsx(y,{variant:"body1",children:"Đang tải thông tin suất chiếu..."}):e.jsxs("form",{onSubmit:b,children:[e.jsxs(W,{spacing:3,children:[e.jsx(h,{name:"film_name",label:"Tên phim",value:a.film_name,onChange:r,required:!0,fullWidth:!0}),e.jsx(h,{name:"room_name",label:"Tên phòng chiếu",value:a.room_name,onChange:r,required:!0,fullWidth:!0}),e.jsx(h,{name:"cinema_name",label:"Tên rạp",value:a.cinema_name,onChange:r,required:!0,fullWidth:!0}),e.jsx(h,{name:"show_date",label:"Ngày chiếu",type:"date",value:a.show_date,onChange:r,required:!0,fullWidth:!0,InputLabelProps:{shrink:!0}}),e.jsx(h,{name:"show_time",label:"Giờ chiếu",type:"time",value:a.show_time,onChange:r,required:!0,fullWidth:!0,InputLabelProps:{shrink:!0}})]}),e.jsx(T,{mt:3,display:"flex",justifyContent:"flex-end",children:e.jsx(k,{type:"submit",variant:"contained",color:"primary",children:"Cập nhật"})})]})})]}),e.jsx(L,{open:d.open,autoHideDuration:6e3,onClose:g,children:e.jsx(N,{onClose:g,severity:d.severity,children:d.message})})]})}function G(){const{id:o}=D();return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsxs("title",{children:[" ","Chỉnh sửa thông tin suất chiếu | Trang quản trị website bán vé xem phim NHTT"]})}),e.jsx($,{showtimeId:o})]})}export{G as default};
